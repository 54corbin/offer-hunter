<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Answer Generation Extension Test Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-content {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .instructions {
            background: #e7f3ff;
            padding: 15px;
            border-left: 4px solid #2196F3;
            margin-bottom: 20px;
        }
        .console-log {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .console-entry {
            margin: 2px 0;
            padding: 2px 0;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .warning { color: #FF9800; }
        .info { color: #2196F3; }
    </style>
</head>
<body>
    <h1>ðŸŽ¯ Answer Generation Extension Test Page</h1>
    
    <div class="instructions">
        <h3>ðŸ“‹ Test Instructions:</h3>
        <ol>
            <li>Load the Offer Hunter browser extension</li>
            <li>Select any text from the content below (minimum 10 characters)</li>
            <li>Click the AI icon that appears</li>
            <li>Click "Generate Answer" button in the popup</li>
            <li>Check browser console for any errors</li>
            <li>Also check the console output section below</li>
        </ol>
    </div>

    <div class="test-content">
        <h2>Sample Job Posting</h2>
        <p>
            <strong>Senior Software Developer Position:</strong>
            We are seeking a talented and experienced Senior Software Developer to join our dynamic team. 
            The ideal candidate will have 5+ years of experience in full-stack development, proficiency in 
            JavaScript, Python, and modern frameworks. Strong problem-solving skills and experience with 
            agile methodologies are required. Experience with cloud platforms (AWS, Azure) and containerization 
            technologies (Docker, Kubernetes) is preferred.
        </p>
        
        <h3>Key Responsibilities:</h3>
        <ul>
            <li>Design and develop scalable web applications</li>
            <li>Collaborate with cross-functional teams</li>
            <li>Mentor junior developers</li>
            <li>Participate in code reviews and technical discussions</li>
        </ul>
    </div>

    <div class="test-content">
        <h2>Technical Question Example</h2>
        <p>
            What is the difference between synchronous and asynchronous programming? 
            When would you use each approach in JavaScript development? 
            Please explain the event loop mechanism and how it handles async operations.
        </p>
    </div>

    <div class="test-content">
        <h2>Interview Question Example</h2>
        <p>
            Tell me about a challenging project you worked on and how you overcame obstacles. 
            What did you learn from that experience, and how has it shaped your approach to problem-solving?
        </p>
    </div>

    <div class="console-log">
        <h3>ðŸ”§ Console Output:</h3>
        <div id="console-output">
            <div class="console-entry info">Initializing test page...</div>
        </div>
    </div>

    <script>
        // Enhanced console logging to show output on page
        const consoleOutput = document.getElementById('console-output');
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addLogEntry(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = `console-entry ${type}`;
            entry.innerHTML = `[${timestamp}] ${message}`;
            consoleOutput.appendChild(entry);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg) : String(arg)
            ).join(' ');
            addLogEntry(`LOG: ${message}`, 'info');
        };

        console.error = function(...args) {
            originalError.apply(console, args);
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg) : String(arg)
            ).join(' ');
            addLogEntry(`ERROR: ${message}`, 'error');
        };

        console.warn = function(...args) {
            originalWarn.apply(console, args);
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg) : String(arg)
            ).join(' ');
            addLogEntry(`WARNING: ${message}`, 'warning');
        };

        // Test extension availability
        function testExtensionAvailability() {
            console.log('Testing extension availability...');
            
            // Check for AnswerGenerationManager
            if (typeof window.answerGenerationManager !== 'undefined') {
                console.log('âœ… AnswerGenerationManager found');
                addLogEntry('âœ… AnswerGenerationManager found', 'success');
            } else {
                console.log('âŒ AnswerGenerationManager not found - extension may not be loaded');
                addLogEntry('âŒ AnswerGenerationManager not found - extension may not be loaded', 'error');
            }
            
            // Check for safeAnswerGenerationManager
            if (typeof window.safeAnswerGenerationManager !== 'undefined') {
                console.log('âœ… SafeAnswerGenerationManager found');
                addLogEntry('âœ… SafeAnswerGenerationManager found', 'success');
            } else {
                console.log('âŒ SafeAnswerGenerationManager not found');
                addLogEntry('âŒ SafeAnswerGenerationManager not found', 'error');
            }

            // Test available methods
            if (window.safeAnswerGenerationManager) {
                const methods = ['generateAnswer', 'copyAnswer', 'exportAnswer'];
                methods.forEach(method => {
                    if (typeof window.safeAnswerGenerationManager[method] === 'function') {
                        console.log(`âœ… Method ${method} is available`);
                        addLogEntry(`âœ… Method ${method} is available`, 'success');
                    } else {
                        console.log(`âŒ Method ${method} is not available`);
                        addLogEntry(`âŒ Method ${method} is not available`, 'error');
                    }
                });
            }
        }

        // Run tests
        setTimeout(testExtensionAvailability, 1000);
        
        // Monitor for late loading
        let checkCount = 0;
        const checkInterval = setInterval(() => {
            checkCount++;
            if (checkCount > 10) {
                clearInterval(checkInterval);
                addLogEntry('Extension loading check completed', 'info');
                return;
            }
            
            if (!window.answerGenerationManager) {
                console.log(`Checking for extension... Attempt ${checkCount}`);
                testExtensionAvailability();
            }
        }, 2000);

        console.log('Test page loaded successfully');
        console.log('Ready to test answer generation functionality');
    </script>
</body>
</html>