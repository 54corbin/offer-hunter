(()=>{"use strict";console.log("Offer Hunter autofill script loaded and ready.");const e={"personalInfo.name":["name","full-name","fullName"],"personalInfo.email":["email","email-address","emailAddress"],"personalInfo.phone":["phone","phone-number","phoneNumber"]},t=(e,t)=>{const o=t.split(".");let n=e;for(const e of o){if(!n||"object"!=typeof n||!(e in n))return;n=n[e]}return"string"==typeof n?n:void 0},o=e=>{var t,o,n,l,r,i,a;if(e.id){const o=document.querySelector(`label[for="${e.id}"]`);if(o)return(null===(t=o.textContent)||void 0===t?void 0:t.trim())||null}if("LABEL"===(null===(o=e.parentElement)||void 0===o?void 0:o.tagName))return(null===(n=e.parentElement.textContent)||void 0===n?void 0:n.trim())||null;const s=e.previousElementSibling;return s&&"LABEL"===s.tagName?(null===(l=s.textContent)||void 0===l?void 0:l.trim())||null:"LABEL"===(null===(i=null===(r=e.parentElement)||void 0===r?void 0:r.previousElementSibling)||void 0===i?void 0:i.tagName)?(null===(a=e.parentElement.previousElementSibling.textContent)||void 0===a?void 0:a.trim())||null:(console.warn("Could not find a label for textarea:",e),null)};chrome.runtime.onMessage.addListener((n,l,r)=>{if("AUTOFILL_DATA"===n.type){const{profile:l,resume:i}=n;if(l&&i){const n=(o=>{console.log("Autofilling simple fields with profile:",o);const n=document.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"]');let l=0;return n.forEach(n=>{var r,i,a,s;const u=n,d=[(null===(r=u.id)||void 0===r?void 0:r.toLowerCase())||"",(null===(i=u.name)||void 0===i?void 0:i.toLowerCase())||"",(null===(a=u.placeholder)||void 0===a?void 0:a.toLowerCase())||"",(null===(s=u.ariaLabel)||void 0===s?void 0:s.toLowerCase())||""].filter(Boolean);for(const n in e){const r=e[n];if(d.some(e=>r.some(t=>e.includes(t)))){const e=t(o,n);e&&(u.value=e,l++);break}}}),l})(l);(()=>{const e=document.querySelectorAll("textarea");console.log(`Found ${e.length} textarea(s) to analyze.`),e.forEach(e=>{const t=o(e);if(t){e.placeholder="Generating answer with AI...";const o=document.body.innerText||"";console.log(`Requesting answer for question: "${t}"`),chrome.runtime.sendMessage({type:"GENERATE_ANSWER",questionText:t,jobDescription:o})}})})(),r({status:`success, ${n} fields filled.`})}else r({status:"error",message:"Profile or resume data missing."})}else if("ANSWER_GENERATED"===n.type){const{questionText:e,answer:t}=n;document.querySelectorAll("textarea").forEach(n=>{o(n)===e&&(n.value=t,n.placeholder="Answer generated by Offer Hunter AI.")})}else if("ANSWER_FAILED"===n.type){const{questionText:e}=n;document.querySelectorAll("textarea").forEach(t=>{o(t)===e&&(t.placeholder="Could not generate an answer. Please try again.")})}return!0})})();