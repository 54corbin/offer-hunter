(()=>{"use strict";({7427:function(){var e=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))(function(i,r){function a(e){try{p(o.next(e))}catch(e){r(e)}}function s(e){try{p(o.throw(e))}catch(e){r(e)}}function p(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,s)}p((o=o.apply(e,n||[])).next())})};console.log("Answer Generation content script loaded."),console.log("Answer Generation: DOM ready state:",document.readyState),console.log("Answer Generation: Current URL:",window.location.href),console.log("Answer Generation: IMMEDIATE wrapper setup starting..."),window.safeAnswerGenerationManager={generateAnswer:()=>{console.log("Safe wrapper: generateAnswer called"),console.log("Safe wrapper: Manager available:",!!window.answerGenerationManager);try{const e=window.answerGenerationManager;return e&&"function"==typeof e.generateAnswer?(console.log("Safe wrapper: Calling manager.generateAnswer"),e.generateAnswer()):(console.error("Safe wrapper: Manager not ready yet, waiting..."),console.log("Safe wrapper: Manager type:",typeof e),console.log("Safe wrapper: Has generateAnswer?",e&&typeof e.generateAnswer),setTimeout(()=>{const e=window.answerGenerationManager;if(console.log("Safe wrapper: Retry - Manager available:",!!window.retryManager),console.log("Safe wrapper: Retry - Manager type:",typeof e),console.log("Safe wrapper: Retry - Has generateAnswer?",e&&typeof e.generateAnswer),e&&"function"==typeof e.generateAnswer)return console.log("Safe wrapper: Retrying manager.generateAnswer"),e.generateAnswer();console.error("Safe wrapper: Manager still not available after retry"),console.log("Safe wrapper: Available window properties:",Object.keys(window).filter(e=>e.includes("answer"))),"undefined"!=typeof alert&&alert("Answer Generation: Extension is loading, please try again in a moment.")},100),Promise.resolve())}catch(e){return console.error("Safe wrapper: Error in generateAnswer:",e),"undefined"!=typeof alert&&alert("Answer Generation: An error occurred. Please try again."),Promise.resolve()}},copyAnswer:e=>{console.log(`Safe wrapper: copyAnswer(${e}) called`);try{const n=window.answerGenerationManager;return n&&"function"==typeof n.copyAnswer?n.copyAnswer(e):(console.error("Safe wrapper: Manager not ready for copyAnswer"),Promise.resolve())}catch(e){return console.error("Safe wrapper: Error in copyAnswer:",e),Promise.resolve()}},exportAnswer:()=>{console.log("Safe wrapper: exportAnswer called");try{const e=window.answerGenerationManager;if(e&&"function"==typeof e.exportAnswer)return e.exportAnswer();console.error("Safe wrapper: Manager not ready for exportAnswer")}catch(e){console.error("Safe wrapper: Error in exportAnswer:",e)}}},console.log("Answer Generation: IMMEDIATE wrapper setup complete"),console.log("Answer Generation: Wrapper available:",typeof window.safeAnswerGenerationManager),window.AGWrapper=window.safeAnswerGenerationManager,console.log("Answer Generation: Backup wrapper AGWrapper also set"),console.log("Answer Generation: Creating AnswerGenerationManager instance");const n=new class{constructor(){this.popupState={isVisible:!1,position:{x:0,y:0},selectedText:"",isInjected:!1},this.popupElement=null,this.hideTimeout=null,this.init()}init(){console.log("Answer Generation: Initializing AnswerGenerationManager"),console.log("Answer Generation: Document ready state:",document.readyState),this.addEventListeners(),console.log("Answer Generation: Initialization complete")}addEventListeners(){let e;console.log("Answer Generation: Adding event listeners"),document.addEventListener("mouseup",()=>{clearTimeout(e),e=setTimeout(()=>{this.handleTextSelection()},300)}),document.addEventListener("keyup",e=>{"Escape"===e.key&&this.hidePopup()}),chrome.runtime.onMessage.addListener((e,n,t)=>{console.log("Answer Generation: Received message:",e),"SHOW_ANSWER_POPUP"===e.type?(console.log("Answer Generation: Showing injected popup"),this.showInjectedPopup(e.data.selectedText,e.data.position),t({status:"ok"})):"HIDE_ANSWER_POPUP"===e.type&&(console.log("Answer Generation: Hiding popup via message"),this.hidePopup(),t({status:"ok"}))}),console.log("Answer Generation: Event listeners added")}handleTextSelection(){console.log("Answer Generation: Text selection event triggered");const e=window.getSelection();if(!e||e.isCollapsed)return console.log("Answer Generation: No selection or collapsed selection"),void this.hidePopup();const n=e.toString().trim();if(console.log("Answer Generation: Selected text length:",n.length),console.log("Answer Generation: Selected text preview:",n.substring(0,50)),n.length<10)return console.log("Answer Generation: Selection too short (minimum 10 chars)"),void this.hidePopup();this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null,console.log("Answer Generation: Cancelled pending hide timeout")),this.popupState.selectedText=n,console.log("Answer Generation: Storing selected text:",n);const t=e.getRangeAt(0).getBoundingClientRect();console.log("Answer Generation: Selection rect:",t);const o={x:t.left+t.width/2,y:t.top-10};console.log("Answer Generation: Calculated position:",o),this.showIcon(o)}showIcon(e){console.log("Answer Generation: showIcon called with position:",e),this.removeIcon();const n=document.createElement("div");n.id="answer-generation-icon",n.style.cssText="\n      position: fixed !important;\n      z-index: 2147483647 !important;\n      background: linear-gradient(135deg, #3B82F6, #2563EB) !important;\n      border: none !important;\n      border-radius: 16px !important;\n      box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3) !important;\n      padding: 8px 12px !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      font-size: 13px !important;\n      cursor: pointer !important;\n      opacity: 0 !important;\n      transform: scale(0.8) !important;\n      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;\n      pointer-events: none !important;\n      display: flex !important;\n      align-items: center !important;\n      gap: 6px !important;\n      justify-content: center !important;\n      color: white !important;\n      font-weight: 600 !important;\n      visibility: hidden !important;\n      user-select: none !important;\n    ",n.innerHTML='\n      <div style="display: flex; align-items: center; gap: 6px; color: white;">\n        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="opacity: 0.9;">\n          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>\n        </svg>\n        <span style="font-size: 12px; font-weight: 500;">AI</span>\n      </div>\n    ';const t=Math.max(10,Math.min(e.x-25,window.innerWidth-70)),o=Math.max(10,e.y-35);n.style.left=`${t}px`,n.style.top=`${o}px`,n.addEventListener("click",()=>{console.log("Answer Generation: Icon clicked"),this.showInjectedPopup(this.popupState.selectedText,e),this.removeIcon()}),document.body.appendChild(n),this.popupElement=n,console.log("Answer Generation: Icon appended to body"),setTimeout(()=>{this.popupElement&&(this.popupElement.style.opacity="1",this.popupElement.style.transform="scale(1)",this.popupElement.style.pointerEvents="auto",this.popupElement.style.visibility="visible")},50),setTimeout(()=>{this.popupState.isVisible&&(console.log("Answer Generation: Minimum display time elapsed, scheduling hide"),this.scheduleHide())},1500)}removeIcon(){const e=document.getElementById("answer-generation-icon");e&&e.remove(),this.popupElement=null}scheduleHide(){console.log("Answer Generation: Scheduling icon hide in 8 seconds"),this.hideTimeout&&clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout(()=>{console.log("Answer Generation: Auto-hiding icon after timeout"),this.removeIcon()},8e3)}hidePopup(){console.log("Answer Generation: hidePopup called");const e=document.getElementById("injected-answer-popup");e&&e.remove(),this.removeIcon(),this.popupState.isVisible=!1,this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null,console.log("Answer Generation: Cleared hide timeout"))}showInjectedPopup(e,n){var t,o;console.log("Answer Generation: showInjectedPopup called"),this.hidePopup();const i=document.createElement("div");i.id="injected-answer-popup",i.style.cssText="\n      position: fixed !important;\n      top: 0 !important;\n      left: 0 !important;\n      width: 100% !important;\n      height: 100% !important;\n      z-index: 2147483647 !important;\n      pointer-events: none !important;\n    ",console.log("Answer Generation: Popup container created with z-index:",i.style.zIndex);const r=document.createElement("div");r.style.cssText="\n      position: absolute !important;\n      pointer-events: auto !important;\n    ",console.log("Answer Generation: Popup content created with pointer-events:",r.style.pointerEvents);const a=Math.min(n.x+20,window.innerWidth-500),s=Math.max(n.y-10,10);r.style.left=`${a}px`,r.style.top=`${s}px`,r.innerHTML=`\n      <div style="\n        background: white !important;\n        border-radius: 12px !important;\n        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04) !important;\n        border: 1px solid #e5e7eb !important;\n        width: 480px !important;\n        max-height: 600px !important;\n        overflow: hidden !important;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      ">\n        \x3c!-- Header --\x3e\n        <div style="\n          display: flex !important;\n          align-items: center !important;\n          justify-content: space-between !important;\n          padding: 16px !important;\n          border-bottom: 1px solid #e5e7eb !important;\n          background: linear-gradient(to right, #eff6ff, #e0e7ff) !important;\n        ">\n          <div style="display: flex !important; align-items: center !important; gap: 12px !important;">\n            <div style="\n              width: 32px !important;\n              height: 32px !important;\n              background: #2563eb !important;\n              border-radius: 8px !important;\n              display: flex !important;\n              align-items: center !important;\n              justify-content: center !important;\n              color: white !important;\n              font-weight: bold !important;\n              font-size: 14px !important;\n            ">\n              AI\n            </div>\n            <div>\n              <h3 style="margin: 0 !important; font-size: 18px !important; font-weight: 600 !important; color: #111827 !important;">\n                Answer Generation\n              </h3>\n              <p style="margin: 0 !important; font-size: 12px !important; color: #6b7280 !important;">\n                AI-powered responses for your selected text\n              </p>\n            </div>\n          </div>\n          <button onclick="this.closest('#injected-answer-popup').remove()" style="\n            background: none !important;\n            border: none !important;\n            cursor: pointer !important;\n            padding: 4px !important;\n            border-radius: 6px !important;\n            color: #6b7280 !important;\n            font-size: 18px !important;\n          ">\n            √ó\n          </button>\n        </div>\n\n        \x3c!-- Content --\x3e\n        <div style="padding: 16px !important; max-height: 500px !important; overflow-y: auto !important;">\n          \x3c!-- Error Display --\x3e\n          <div id="popup-error" style="display: none !important; margin-bottom: 16px !important; padding: 12px !important; background: #fef2f2 !important; border: 1px solid #fecaca !important; border-radius: 8px !important;">\n            <p id="error-message" style="margin: 0 !important; font-size: 14px !important; color: #b91c1c !important;"></p>\n          </div>\n\n          \x3c!-- Selected Text --\x3e\n          <div style="margin-bottom: 16px !important;">\n            <label style="display: block !important; font-size: 14px !important; font-weight: 500 !important; color: #374151 !important; margin-bottom: 8px !important;">\n              Selected Text:\n            </label>\n            <div style="\n              background: #eff6ff !important;\n              padding: 12px !important;\n              border-radius: 8px !important;\n              border: 1px solid #dbeafe !important;\n              max-height: 80px !important;\n              overflow-y: auto !important;\n            ">\n              <p id="selected-text-display" style="margin: 0 !important; font-size: 14px !important; color: #374151 !important; font-style: italic !important;">\n                "${e.length>100?e.substring(0,100)+"...":e}"\n              </p>\n            </div>\n          </div>\n\n          \x3c!-- Prompt Templates --\x3e\n          <div style="margin-bottom: 16px !important;">\n            <label style="display: block !important; font-size: 14px !important; font-weight: 500 !important; color: #374151 !important; margin-bottom: 8px !important;">\n              Prompt Template:\n            </label>\n            <select id="template-selector" style="\n              width: 100% !important;\n              padding: 8px 12px !important;\n              border: 1px solid #d1d5db !important;\n              border-radius: 6px !important;\n              font-size: 14px !important;\n              background: white !important;\n              margin-bottom: 8px !important;\n            ">\n              <option value="job-application">üíº Job Application - Tailored responses</option>\n              <option value="technical-question">‚öôÔ∏è Technical Question - Detailed explanations</option>\n              <option value="interview-response">üé§ Interview Response - STAR method</option>\n              <option value="general-explanation">üí¨ General Explanation - Clear information</option>\n            </select>\n\n            \x3c!-- Quick Settings --\x3e\n            <div style="margin-bottom: 12px !important;">\n              <label style="display: block !important; font-size: 12px !important; font-weight: 500 !important; color: #6b7280 !important; margin-bottom: 4px !important;">\n                Tone:\n              </label>\n              <div style="display: flex !important; gap: 4px !important; margin-bottom: 8px !important;">\n                <button data-setting="tone" data-value="professional" class="setting-btn" style="\n                  padding: 4px 8px !important;\n                  font-size: 12px !important;\n                  border: 1px solid #d1d5db !important;\n                  border-radius: 4px !important;\n                  background: #2563eb !important;\n                  color: white !important;\n                  cursor: pointer !important;\n                ">Professional</button>\n                <button data-setting="tone" data-value="casual" class="setting-btn" style="\n                  padding: 4px 8px !important;\n                  font-size: 12px !important;\n                  border: 1px solid #d1d5db !important;\n                  border-radius: 4px !important;\n                  background: white !important;\n                  color: #374151 !important;\n                  cursor: pointer !important;\n                ">Casual</button>\n                <button data-setting="tone" data-value="technical" class="setting-btn" style="\n                  padding: 4px 8px !important;\n                  font-size: 12px !important;\n                  border: 1px solid #d1d5db !important;\n                  border-radius: 4px !important;\n                  background: white !important;\n                  color: #374151 !important;\n                  cursor: pointer !important;\n                ">Technical</button>\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- Generate Button --\x3e\n          <button id="generate-btn" onclick="(window.safeAnswerGenerationManager||{}).generateAnswer && (window.safeAnswerGenerationManager).generateAnswer()" style="\n            width: 100% !important;\n            background: linear-gradient(to right, #2563eb, #4f46e5) !important;\n            color: white !important;\n            border: none !important;\n            padding: 12px 16px !important;\n            border-radius: 8px !important;\n            font-size: 14px !important;\n            font-weight: 500 !important;\n            cursor: pointer !important;\n            margin-bottom: 16px !important;\n            transition: all 0.2s ease !important;\n          ">\n            üöÄ Generate Answer\n          </button>\n\n          \x3c!-- Loading State --\x3e\n          <div id="loading-state" style="display: none !important; text-align: center !important; margin-bottom: 16px !important;">\n            <div style="\n              display: inline-flex !important;\n              align-items: center !important;\n              gap: 8px !important;\n              color: #6b7280 !important;\n              font-size: 14px !important;\n            ">\n              <div style="\n                width: 16px !important;\n                height: 16px !important;\n                border: 2px solid #e5e7eb !important;\n                border-top: 2px solid #2563eb !important;\n                border-radius: 50% !important;\n                animation: spin 1s linear infinite !important;\n              "></div>\n              Generating answer...\n            </div>\n          </div>\n\n          \x3c!-- Generated Answer --\x3e\n          <div id="answer-section" style="display: none !important; margin-bottom: 16px !important;">\n            <label style="display: block !important; font-size: 14px !important; font-weight: 500 !important; color: #374151 !important; margin-bottom: 8px !important;">\n              Generated Answer:\n            </label>\n            <div style="\n              background: #f0fdf4 !important;\n              padding: 16px !important;\n              border-radius: 8px !important;\n              border: 1px solid #bbf7d0 !important;\n              max-height: 200px !important;\n              overflow-y: auto !important;\n            ">\n              <p id="generated-answer" style="margin: 0 !important; font-size: 14px !important; color: #1f2937 !important; white-space: pre-wrap !important; line-height: 1.5 !important;"></p>\n            </div>\n\n            \x3c!-- Action Buttons --\x3e\n            <div style="display: flex !important; gap: 8px !important; margin-top: 12px !important; flex-wrap: wrap !important;">\n              <button onclick="(window.safeAnswerGenerationManager||{}).copyAnswer && (window.safeAnswerGenerationManager).copyAnswer('plain')" style="\n                padding: 8px 12px !important;\n                background: #2563eb !important;\n                color: white !important;\n                border: none !important;\n                border-radius: 6px !important;\n                font-size: 12px !important;\n                cursor: pointer !important;\n                transition: background 0.2s ease !important;\n              ">üìã Copy</button>\n\n              <button onclick="(window.safeAnswerGenerationManager||{}).copyAnswer && (window.safeAnswerGenerationManager).copyAnswer('linkedin')" style="\n                padding: 8px 12px !important;\n                background: #0077b5 !important;\n                color: white !important;\n                border: none !important;\n                border-radius: 6px !important;\n                font-size: 12px !important;\n                cursor: pointer !important;\n                transition: background 0.2s ease !important;\n              ">üíº LinkedIn</button>\n\n              <button onclick="(window.safeAnswerGenerationManager||{}).exportAnswer && (window.safeAnswerGenerationManager).exportAnswer()" style="\n                padding: 8px 12px !important;\n                background: #10b981 !important;\n                color: white !important;\n                border: none !important;\n                border-radius: 6px !important;\n                font-size: 12px !important;\n                cursor: pointer !important;\n                transition: background 0.2s ease !important;\n              ">üíæ Export</button>\n            </div>\n          </div>\n\n          \x3c!-- Copy Success Message --\x3e\n          <div id="copy-success" style="display: none !important; text-align: center !important; margin-top: 12px !important; padding: 8px !important; background: #d1fae5 !important; color: #065f46 !important; border-radius: 6px !important; font-size: 12px !important;">\n            ‚úÖ Answer copied to clipboard!\n          </div>\n\n          \x3c!-- Resume Context --\x3e\n          <div id="resume-context" style="\n            margin-top: 16px !important;\n            padding: 16px !important;\n            background: linear-gradient(135deg, #eff6ff, #f0f9ff) !important;\n            border: 1px solid #dbeafe !important;\n            border-radius: 12px !important;\n            display: none !important;\n            position: relative !important;\n          ">\n            <div style="\n              display: flex !important; \n              align-items: center !important; \n              gap: 8px !important; \n              margin-bottom: 8px !important;\n            ">\n              <div style="\n                width: 12px !important; \n                height: 12px !important; \n                background: #10b981 !important; \n                border-radius: 50% !important;\n                animation: pulse 2s infinite !important;\n              "></div>\n              <span style="\n                font-size: 14px !important; \n                font-weight: 600 !important; \n                color: #1e40af !important;\n              ">\n                üéØ Active Resume Profile\n              </span>\n            </div>\n            <p id="resume-info" style="\n              margin: 0 !important; \n              font-size: 13px !important; \n              color: #1e3a8a !important; \n              line-height: 1.4 !important;\n            "></p>\n            <div style="\n              display: flex !important; \n              align-items: center !important; \n              gap: 8px !important; \n              margin-top: 8px !important;\n            ">\n              <p id="relevance-score" style="\n                margin: 0 !important; \n                font-size: 11px !important; \n                color: #059669 !important;\n                background: rgba(16, 185, 129, 0.1) !important;\n                padding: 2px 6px !important;\n                border-radius: 4px !important;\n                font-weight: 500 !important;\n              "></p>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;const p=document.createElement("style");p.textContent="\n      @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n      @keyframes pulse {\n        0%, 100% { opacity: 1; }\n        50% { opacity: 0.5; }\n      }\n      .setting-btn:hover {\n        opacity: 0.8 !important;\n      }\n    ",document.head.appendChild(p),i.appendChild(r),document.body.appendChild(i),console.log("Answer Generation: Popup appended to body"),this.popupState.isVisible=!0,this.popupState.selectedText=e,console.log("Answer Generation: Final popup state:",{popupExists:!!document.getElementById("injected-answer-popup"),popupZIndex:null===(t=document.getElementById("injected-answer-popup"))||void 0===t?void 0:t.style.zIndex,popupPointerEvents:null===(o=document.getElementById("injected-answer-popup"))||void 0===o?void 0:o.style.pointerEvents,contentPointerEvents:r.style.pointerEvents,bodyHasPopup:document.body.contains(i)}),this.initializePopupFunctionality(),console.log("Answer Generation: Full featured popup created")}initializePopupFunctionality(){console.log("Answer Generation: Initializing popup functionality"),this.autoDetectTemplate(),this.loadResumeContext(),this.setupSettingsButtons(),this.setupGenerateButton(),window.answerGenerationManager=this}setupGenerateButton(){console.log("Answer Generation: Setting up generate button"),setTimeout(()=>{const e=document.getElementById("generate-btn");console.log("Answer Generation: Generate button found:",!!e),e?(console.log("Answer Generation: Generate button details:",{id:e.id,disabled:e.disabled,style:e.style.cssText,visible:e.offsetWidth>0&&e.offsetHeight>0,zIndex:e.style.zIndex,pointerEvents:e.style.pointerEvents}),e.addEventListener("click",e=>{console.log("Answer Generation: Generate button clicked via event listener!"),e.preventDefault(),e.stopPropagation(),this.generateAnswer()}),console.log("Answer Generation: Event listener added to generate button")):console.error("Answer Generation: Generate button not found!")},100)}autoDetectTemplate(){const e=this.popupState.selectedText.toLowerCase(),n=document.getElementById("template-selector");e.includes("job")||e.includes("position")||e.includes("requirements")?n.value="job-application":e.includes("code")||e.includes("technical")||e.includes("api")?n.value="technical-question":e.includes("interview")||e.includes("tell me")||e.includes("describe")?n.value="interview-response":n.value="general-explanation"}loadResumeContext(){return e(this,void 0,void 0,function*(){var e,n,t,o;try{const i=this.popupState.selectedText.toLowerCase(),r=document.getElementById("resume-context"),a=document.getElementById("resume-info"),s=document.getElementById("relevance-score");if(i.includes("job")||i.includes("position")||i.includes("experience")||i.includes("skills")||i.includes("qualification")||i.includes("requirement")){const p=yield this.getUserProfileFromStorage();if(p&&p.resumes&&p.resumes.length>0){const l=null===(e=p.settings)||void 0===e?void 0:e.activeResumeId,d=p.resumes.find(e=>e.id===l)||p.resumes[0];if(d){const e=null===(n=d.parsedInfo)||void 0===n?void 0:n.personalInfo,p=(null===(t=d.parsedInfo)||void 0===t?void 0:t.skills)||[],l=(null===(o=d.parsedInfo)||void 0===o?void 0:o.experience)||[];let c=`Using "${d.name}" as active resume`;if((null==e?void 0:e.name)&&(c+=` ‚Ä¢ ${e.name}`),l.length>0){const e=l[0];c+=` ‚Ä¢ ${e.title} at ${e.company}`}p.length>0&&(c+=` ‚Ä¢ Skills: ${p.slice(0,3).join(", ")}`),a.textContent=c;const m=this.calculateRelevanceScore(i,d.text,p);s.textContent=`‚úì ${m}% relevance based on your background`,r.style.display="block"}else console.log("No active resume found")}else a.textContent="No resume profile found. Upload a resume to enable personalized responses.",s.textContent="",r.style.display="block"}}catch(e){console.error("Error loading resume context:",e);const n=document.getElementById("resume-context");n&&(n.style.display="none")}})}getUserProfileFromStorage(){return e(this,void 0,void 0,function*(){return new Promise(e=>{chrome&&chrome.storage&&chrome.storage.local?chrome.storage.local.get(["userProfile"],n=>{n.userProfile?e(n.userProfile):e(null)}):(console.warn("chrome.storage.local is not available. Cannot fetch resume context."),e(null))})})}calculateRelevanceScore(e,n,t){let o=0;const i=e.toLowerCase().split(/\s+/),r=n.toLowerCase().split(/\s+/),a=t.filter(n=>e.toLowerCase().includes(n.toLowerCase())).length;o+=Math.min(20*a,60);const s=i.filter(e=>e.length>3&&r.some(n=>n.includes(e))).length;return o+=Math.min(2*s,30),0===o&&(e.includes("job")||e.includes("position")||e.includes("experience"))&&(o=40),Math.min(Math.max(o,25),95)}setupSettingsButtons(){document.querySelectorAll(".setting-btn").forEach(e=>{e.addEventListener("click",e=>{const n=e.target,t=n.getAttribute("data-setting");n.getAttribute("data-value"),document.querySelectorAll(`[data-setting="${t}"]`).forEach(e=>{e.style.background="white",e.style.color="#374151"}),n.style.background="#2563eb",n.style.color="white"})})}generateAnswer(){return e(this,void 0,void 0,function*(){console.log("Answer Generation: Starting answer generation"),console.log("Answer Generation: Method called on manager:",this),console.log("Answer Generation: Document ready state:",document.readyState),console.log("Answer Generation: Selected text:",this.popupState.selectedText),console.log("Answer Generation: Popup visible:",this.popupState.isVisible);const e=document.getElementById("injected-answer-popup");console.log("Answer Generation: Popup exists:",!!e);const n=document.getElementById("generate-btn"),t=document.getElementById("loading-state"),o=document.getElementById("answer-section"),i=document.getElementById("popup-error"),r=document.getElementById("error-message");console.log("Answer Generation: DOM elements found:",{generateBtn:!!n,loadingState:!!t,answerSection:!!o,errorDiv:!!i,errorMsg:!!r}),n.style.display="none",t.style.display="block",o.style.display="none",i.style.display="none";try{console.log("Answer Generation: Entering try block");const e=document.getElementById("template-selector").value;console.log("Answer Generation: Template selected:",e);const n=document.querySelector('.setting-btn[style*="background: #2563eb"]'),t=(null==n?void 0:n.getAttribute("data-value"))||"professional";console.log("Answer Generation: Tone selected:",t);const i=this.createPrompt(e,t);console.log("Answer Generation: Generated prompt:",i.substring(0,200)+"..."),yield new Promise(e=>setTimeout(e,2e3));const r=this.generateMockAnswer(e,t);document.getElementById("generated-answer").textContent=r,o.style.display="block"}catch(e){console.error("Answer generation error:",e),r.textContent="Failed to generate answer. Please try again.",i.style.display="block"}finally{n.style.display="block",t.style.display="none"}})}createPrompt(e,n){const t=this.popupState.selectedText,o={"job-application":`You are a professional career coach. Generate a compelling response for a job application based on this text: "${t}". Use a ${n} tone and highlight relevant qualifications and experience.`,"technical-question":`You are a technical expert. Provide a detailed explanation of this technical concept: "${t}". Use a ${n} tone with specific examples and clear explanations.`,"interview-response":`You are an interview coach. Help craft a thoughtful response to this interview question: "${t}". Use the STAR method and a ${n} tone to showcase relevant experience.`,"general-explanation":`You are a helpful assistant. Provide a clear, informative explanation about: "${t}". Use a ${n} tone and make it easy to understand.`};return o[e]||o["general-explanation"]}generateMockAnswer(e,n){const t={"job-application":"Based on the requirements you've outlined, I believe I would be an excellent fit for this position. My background includes extensive experience in project management, team leadership, and strategic planning - all key areas you've mentioned as important for success in this role.\n\nIn my previous position, I successfully managed cross-functional teams of 15+ members, delivering complex projects on time and under budget. This experience has given me strong skills in communication, problem-solving, and stakeholder management that directly align with what you're looking for.\n\nI'm particularly excited about the opportunity to contribute to your organization's growth and would welcome the chance to discuss how my experience can benefit your team.","technical-question":"This is an excellent technical question that requires a comprehensive approach. Here's how I would address it:\n\n**Technical Analysis:**\n- The core issue involves understanding the underlying architecture and data flow\n- Performance considerations are critical when scaling to production levels\n- Security implications must be evaluated throughout the implementation\n\n**Recommended Solution:**\n1. Begin with a solid foundation using established patterns\n2. Implement proper error handling and validation\n3. Add comprehensive testing coverage\n4. Consider monitoring and observability from day one\n\n**Best Practices:**\n- Follow SOLID principles and clean architecture patterns\n- Use dependency injection for better testability\n- Implement proper logging and monitoring\n- Ensure code is well-documented and maintainable\n\nThe key is to balance immediate functionality with long-term maintainability and scalability.","interview-response":"That's a great question. Let me tell you about a challenging project that really demonstrated my problem-solving abilities.\n\n**Situation:** In my previous role, we faced a critical system failure just before a major client presentation. The application's performance had degraded significantly due to database issues, and we had less than 24 hours to resolve it.\n\n**Task:** As the technical lead, I needed to diagnose the root cause quickly and implement a solution that wouldn't break anything else.\n\n**Action:** I immediately gathered the team and created a diagnostic plan. We discovered that database queries weren't optimized, causing slow response times. I worked with the database team to implement query optimization and added proper indexing. I also implemented caching to reduce database load.\n\n**Result:** We not only fixed the immediate issue but improved overall system performance by 40%. The presentation went perfectly, and the client was impressed with both the solution and our responsiveness.\n\nThis experience taught me the importance of systematic problem-solving and the value of cross-team collaboration under pressure.","general-explanation":"Let me break this down into clear, manageable components:\n\n**Key Concepts:**\n- This topic involves multiple interconnected elements that work together\n- Understanding the fundamental principles makes the details much clearer\n- Real-world examples help illustrate abstract concepts\n\n**Practical Application:**\n- Start with the basics and build complexity gradually\n- Focus on understanding *why* something works, not just *how*\n- Practice with hands-on examples to reinforce learning\n- Don't hesitate to ask questions when something isn't clear\n\n**Best Approach:**\n1. Begin with the high-level overview to see the big picture\n2. Dive into specific components one at a time\n3. Look for patterns and connections between different parts\n4. Apply what you've learned to practical scenarios\n\nThe most effective way to master this topic is through consistent practice and gradual exposure to increasingly complex scenarios."};return t[e]||t["general-explanation"]}copyAnswer(n){return e(this,void 0,void 0,function*(){const e=document.getElementById("generated-answer").textContent||"";let t=e;"linkedin"===n&&(t=`üíº ${e}\n\n#Career #Professional #JobSearch`);try{yield navigator.clipboard.writeText(t);const e=document.getElementById("copy-success");e.style.display="block",setTimeout(()=>{e.style.display="none"},2e3)}catch(e){console.error("Failed to copy to clipboard:",e),alert("Failed to copy to clipboard. Please try again.")}})}exportAnswer(){const e=document.getElementById("generated-answer").textContent||"",n=document.getElementById("template-selector").value,t=(new Date).toISOString().split("T")[0],o=`# Generated Answer\n\n**Template:** ${n}\n**Generated:** ${(new Date).toLocaleString()}\n**Source Text:** ${this.popupState.selectedText}\n\n## Generated Answer:\n${e}`,i=new Blob([o],{type:"text/markdown"}),r=URL.createObjectURL(i),a=document.createElement("a");a.href=r,a.download=`answer-${n}-${t}.md`,a.click(),URL.revokeObjectURL(r)}testPopup(){console.log("Answer Generation: Manual test popup called");const e={x:200,y:200};this.popupState.selectedText="This is test text for popup verification. Select any text to test the real functionality.",console.log("Answer Generation: Showing test popup at position:",e),this.showInjectedPopup(this.popupState.selectedText,e)}debugPopup(){console.log("Answer Generation: Debug popup state:",{popupElement:this.popupElement,popupState:this.popupState,isInDOM:!!document.getElementById("answer-generation-popup"),injectedPopup:!!document.getElementById("injected-answer-popup")})}};window.answerGenerationManager=n,window.generateAnswer=()=>n.generateAnswer(),window.copyAnswer=e=>n.copyAnswer(e),window.exportAnswer=()=>n.exportAnswer(),window.testAnswerGenerationPopup=()=>n.testPopup(),window.debugAnswerGenerationPopup=()=>n.debugPopup(),window.manualTestGenerate=()=>(console.log("Manual test: Calling generateAnswer directly"),n.generateAnswer()),console.log("Answer Generation: Test methods available:"),console.log("- window.testAnswerGenerationPopup() - Test popup manually"),console.log("- window.debugAnswerGenerationPopup() - Debug popup state"),console.log("- window.manualTestGenerate() - Test generateAnswer directly")}})[7427]()})();